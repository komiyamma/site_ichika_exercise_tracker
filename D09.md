### ğŸ“¤ ç¬¬9ç« ï¼šãƒ‡ãƒ¼ã‚¿ã®è¡¨ç¤ºï¼ˆæ€è€ƒã®è»Œè·¡ç·¨ï¼‰

---

## ğŸŒŸ 9.1 ä¿å­˜ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ãˆã‚‹å½¢ã«ã™ã‚‹

ç¬¬8ç« ã¾ã§ã§ã€ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã« `localStorage` ã¸ãƒ‡ãƒ¼ã‚¿ã‚’è“„ç©ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚  
ã“ã“ã§ã¯ã€ãã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ†ãƒ¼ãƒ–ãƒ«ã¸æç”»ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒçµæœã‚’ç›®ã§è¿½ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

### åˆå¿ƒè€…ã®æ‚©ã¿

- ã€Œãƒ‡ãƒ¼ã‚¿ã¯æºœã¾ã£ã¦ã„ã‚‹ã¯ãšãªã®ã«ã€ç”»é¢ä¸Šã¯ä½•ã‚‚å¤‰ã‚ã‚‰ãªã„â€¦ã€
- ã€Œã©ã“ã§ HTML ã‚’çµ„ã¿ç«‹ã¦ã‚Œã°ã„ã„ã®ã‹ã‚ã‹ã‚‰ãªã„ã€

### åˆ¶ä½œè€…ã®æ€è€ƒã®è»Œè·¡

1. è¡¨ç¤ºã«å¿…è¦ãªè¦ç´ ï¼ˆ`<tbody id="list">` ãªã©ï¼‰ã‚’ `assignElementReferences()` ã«è¿½åŠ ã™ã‚‹ã€‚
2. `renderEntryTable()` ã‚’ä½œã‚Šã€é…åˆ—ã‹ã‚‰ `<tr>` ã‚’çµ„ã¿ç«‹ã¦ã¦ `innerHTML` ã¸æµã—è¾¼ã‚€ã€‚
3. ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å¾Œã¨ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã« `renderEntryTable()` ã‚’å‘¼ã³å‡ºã—ã€å¸¸ã«æœ€æ–°çŠ¶æ…‹ã‚’è¡¨ç¤ºã™ã‚‹ã€‚

---

## ğŸ§° 9.2 è¡¨ç¤ºç”¨ã®è¦ç´ å‚ç…§ã‚’è¿½åŠ ã™ã‚‹

ç¬¬8ç« ã§ã¾ã¨ã‚ãŸãƒ•ã‚©ãƒ¼ãƒ è¦ç´ ã«åŠ ãˆã¦ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã‚„ä»¶æ•°è¡¨ç¤ºç”¨ã®è¦ç´ ã‚‚å¤‰æ•°ã«ä¿æŒã—ã¾ã™ã€‚

```javascript
let entryListElement;
let totalCountElement;

function assignElementReferences() {
    entryFormElement = document.getElementById('entry-form');
    dateInputElement = document.getElementById('date');
    typeInputElement = document.getElementById('type');
    minutesInputElement = document.getElementById('minutes');
    valueInputElement = document.getElementById('value');
    noteInputElement = document.getElementById('note');

    entryListElement = document.getElementById('list');
    totalCountElement = document.getElementById('total-count');
}
```

> å¾Œã®ç« ï¼ˆç¬¬10ç« ä»¥é™ï¼‰ã§å‰Šé™¤ãƒœã‚¿ãƒ³ã‚„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’æ‰±ã†ã¨ãã‚‚ã€ã“ã“ã«å¯¾è±¡è¦ç´ ã‚’è¿½åŠ ã—ã¦ä½¿ã„å›ã—ã¾ã™ã€‚

---

## ğŸŒ¸ 9.3 `renderEntryTable()` ã‚’å®Ÿè£…ã™ã‚‹

`loadEntriesFromStorage()` ã§å–å¾—ã—ãŸé…åˆ—ã‹ã‚‰ `<tr>` ã‚’çµ„ã¿ç«‹ã¦ã€`innerHTML` ã«ã¾ã¨ã‚ã¦æµã—è¾¼ã¿ã¾ã™ã€‚

```javascript
function renderEntryTable() {
    const entries = loadEntriesFromStorage();

    let tableHtml = '';
    for (const entry of entries) {
        tableHtml += `
            <tr>
                <td>${entry.date}</td>
                <td>${entry.type}</td>
                <td class="text-end">${entry.minutes || ''}</td>
                <td class="text-end">${entry.value || ''}</td>
                <td>${entry.note || ''}</td>
            </tr>
        `;
    }

    if (entries.length === 0) {
        tableHtml = '<tr><td colspan="5">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
    }

    entryListElement.innerHTML = tableHtml;
    totalCountElement.textContent = String(entries.length);
}
```

> å®Œæˆç‰ˆï¼ˆ`script.js`ï¼‰ã§ã¯ `escapeHtml()` ã‚’æŒŸã‚“ã§ XSS ã‚’é˜²ã„ã ã‚Šã€Delete ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã—ãŸã‚Šã—ã¦ã„ã¾ã™ã€‚ã¾ãšã¯è¡¨ç¤ºã®ä»•çµ„ã¿ã‚’ç†è§£ã™ã‚‹ã“ã¨ã‚’å„ªå…ˆã—ã¾ã—ã‚‡ã†ã€‚

---

## ğŸ”„ 9.4 ä¿å­˜ã¨è¡¨ç¤ºã‚’ã¤ãªã

ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å¾Œã¨ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ç›´å¾Œã« `renderEntryTable()` ã‚’å‘¼ã³å‡ºã™ã‚ˆã†ã«ã—ã¾ã™ã€‚

```javascript
function handleFormSubmit(event) {
    event.preventDefault();

    const entry = getFormData();
    const entries = loadEntriesFromStorage();
    entries.push(entry);
    saveEntriesToStorage(entries);

    entryFormElement.reset();
    renderEntryTable();
}

function initializePage() {
    assignElementReferences();
    attachEventListeners();
    renderEntryTable(); // ä¿å­˜æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã‚’æœ€åˆã«è¡¨ç¤º
}

document.addEventListener('DOMContentLoaded', initializePage);
```

ã“ã‚Œã§ã€å…¥åŠ› â†’ ä¿å­˜ â†’ å³è¡¨ç¤º ã¨ã„ã†æµã‚ŒãŒ 1 æœ¬ã®ç·šã§ã¤ãªãŒã‚Šã¾ã—ãŸã€‚

---

## ğŸ‘€ 9.5 å‹•ä½œãƒã‚§ãƒƒã‚¯

1. ãƒ•ã‚©ãƒ¼ãƒ ã«å€¤ã‚’å…¥ã‚Œã¦é€ä¿¡ã—ã¦ã¿ã‚‹ã€‚
2. ãƒ†ãƒ¼ãƒ–ãƒ«ã«æ–°ã—ã„è¡ŒãŒè¿½åŠ ã•ã‚Œã€ä»¶æ•°è¡¨ç¤ºï¼ˆ`#total-count`ï¼‰ã‚‚å¢—ãˆã¦ã„ã‚‹ã‹ç¢ºèªã€‚
3. ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚ã€ä¿å­˜æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ãŒæœ€åˆã‹ã‚‰è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºã‹ã‚ã‚‹ã€‚
4. å¿…è¦ã«å¿œã˜ã¦ `console.log(loadEntriesFromStorage())` ã‚„ `console.log(entries)` ã‚’æŒŸã¿ã€é…åˆ—ã®ä¸­èº«ãŒæƒ³å®šé€šã‚Šå¤‰åŒ–ã—ã¦ã„ã‚‹ã‹ã‚’è¿½è·¡ã™ã‚‹ã€‚

> æƒ³å®šé€šã‚Šã«å‹•ã‹ãªã„å ´åˆã¯ã€`renderEntryTable` ã®å†’é ­ã§ `console.log(entries)` ã‚’å‡ºã—ã¦ã€ã€Œé…åˆ—ã«ã¯ä½•ãŒå…¥ã£ã¦ã„ã‚‹ã‹ã€ã€Œãƒ†ãƒ¼ãƒ–ãƒ«ãŒç©ºã«ãªã£ã¦ã„ãªã„ã‹ã€ã‚’é †ç•ªã«ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

---

## # **å…¨ä½“ã®JavaScriptã‚³ãƒ¼ãƒ‰**

```javascript
const WORKOUT_STORAGE_KEY = 'ichikaWorkoutLogEntries';

let entryFormElement;
let dateInputElement;
let typeInputElement;
let minutesInputElement;
let valueInputElement;
let noteInputElement;
let entryListElement;
let totalCountElement;

function assignElementReferences() {
    entryFormElement = document.getElementById('entry-form');
    dateInputElement = document.getElementById('date');
    typeInputElement = document.getElementById('type');
    minutesInputElement = document.getElementById('minutes');
    valueInputElement = document.getElementById('value');
    noteInputElement = document.getElementById('note');
    entryListElement = document.getElementById('list');
    totalCountElement = document.getElementById('total-count');
}

function attachEventListeners() {
    entryFormElement.addEventListener('submit', handleFormSubmit);
}

function generateEntryId() {
    return Date.now();
}

function getFormData() {
    const timestamp = generateEntryId();

    return {
        id: String(timestamp),
        date: dateInputElement.value,
        type: typeInputElement.value,
        minutes: parseInt(minutesInputElement.value, 10) || 0,
        value: parseInt(valueInputElement.value, 10) || 0,
        note: noteInputElement.value.trim(),
        createdAt: timestamp
    };
}

function loadEntriesFromStorage() {
    const rawData = localStorage.getItem(WORKOUT_STORAGE_KEY);
    return rawData ? JSON.parse(rawData) : [];
}

function saveEntriesToStorage(entries) {
    localStorage.setItem(WORKOUT_STORAGE_KEY, JSON.stringify(entries));
}

function handleFormSubmit(event) {
    event.preventDefault();

    const entry = getFormData();
    const entries = loadEntriesFromStorage();
    entries.push(entry);
    saveEntriesToStorage(entries);

    entryFormElement.reset();
    renderEntryTable();
}

function renderEntryTable() {
    const entries = loadEntriesFromStorage();

    let tableHtml = '';
    for (const entry of entries) {
        tableHtml += `
            <tr>
                <td>${entry.date}</td>
                <td>${entry.type}</td>
                <td class="text-end">${entry.minutes || ''}</td>
                <td class="text-end">${entry.value || ''}</td>
                <td>${entry.note || ''}</td>
            </tr>
        `;
    }

    if (entries.length === 0) {
        tableHtml = '<tr><td colspan="5">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
    }

    entryListElement.innerHTML = tableHtml;
    totalCountElement.textContent = String(entries.length);
}

function initializePage() {
    assignElementReferences();
    attachEventListeners();
    renderEntryTable();
}

document.addEventListener('DOMContentLoaded', initializePage);
```

---

ã“ã‚Œã§ä¿å­˜ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ç”»é¢ã«è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚  
æ¬¡ç« ã§ã¯ Delete ãƒœã‚¿ãƒ³ãªã©ã®æ“ä½œã‚’è¿½åŠ ã—ã€è¦‹ãŸç›®ã ã‘ã§ãªãã€Œå‹•ã‹ã›ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã€ã¸ã¨è‚²ã¦ã¦ã„ãã¾ã™ã€‚
