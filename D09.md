
# 🌀 第9章：データの表示 🐾

## 🌟 9.1 思考の軌跡：データを表示する準備

これまでの章で、ユーザーが **フォームに入力したデータを`localStorage`に保存** する仕組みを作成しました。しかし、データが保存された後、 **そのデータを画面に表示する** 部分がまだ実装されていません。データが保存されても、 **ユーザーには何も見えなければ意味がない** ため、ここで重要なのは、保存されたデータを **ユーザーに見せる方法** を考えることです。

### **初心者の悩み** ：

「データは保存できたけれど、保存した **データをどう画面に表示** するのかがわからない。どこから始めていいのかわからない。」

### **制作者の思考の軌跡** ：

「データを保存したら、次は **そのデータを画面に表示する方法** を考えよう。画面に表示するためには、まず **`localStorage`からデータを取り出し** 、それを **HTMLのテーブルに表示** する必要がある。これからその手順を一つ一つ実装していこう。」

---

## 🌼 9.2 `localStorage`からデータを取得する

### **データを取り出す準備**

まず、`localStorage`に保存したデータを **JavaScriptで取得** する必要があります。`localStorage`は文字列としてデータを保存しているので、 **`JSON.parse()`** を使って **オブジェクトとして扱えるように変換** する必要があります。

### **思考の軌跡** ：

「`localStorage`に保存されたデータは **文字列** として保存されているので、 **`JSON.parse()`** を使ってそれを **オブジェクト** として扱えるようにしないといけない。」

#### **`localStorage`からデータを取得するコード** ：

```javascript
// `localStorage`からデータを取得
function loadEntriesFromStorage() {
    const rawData = localStorage.getItem('ichikaWorkoutLogEntries'); // 保存されたデータを文字列で取得
    return rawData ? JSON.parse(rawData) : []; // データが無ければ空配列を返す
}
```

* **`localStorage.getItem('ichikaWorkoutLogEntries')`** でデータを取得します。このデータは文字列なので、 **`JSON.parse()`** を使って、JavaScriptのオブジェクト（配列）に変換します。
* データがない場合（初めてページを開いたときなど）は、空の配列（`[]`）を返すようにしています。これにより、エラーを防ぎます。

---

## 🌸 9.3 データをテーブル形式で表示する

次に、取得したデータを画面に表示するために、 **HTMLのテーブルにデータを反映させる** 処理を行います。保存された運動記録が、テーブルの行（`<tr>`）として表示される仕組みを作ります。

### **思考の軌跡** ：

「データを取得した後、それを **テーブルに挿入する** 必要がある。もしデータがない場合には、 **『データがありません』** と表示するようにしよう。データがあれば、その内容をテーブルに挿入する。」

#### **データをテーブルに表示するコード** ：

```javascript
function renderEntryTable() {
    const entries = loadEntriesFromStorage(); // `localStorage`からデータを取得
    const entryListElement = document.getElementById('list'); // データを挿入する場所

    // データがない場合は「データがありません」と表示
    if (entries.length === 0) {
        entryListElement.innerHTML = '<tr><td colspan="5">データがありません</td></tr>';
        return;
    }

    // データがある場合、テーブルに表示する
    let tableHtml = ''; // 空の文字列から始める
    for (const entry of entries) {
        tableHtml += `
            <tr>
                <td>${entry.date}</td>
                <td>${entry.type}</td>
                <td class="text-end">${entry.minutes || ''}</td>
                <td class="text-end">${entry.value || ''}</td>
                <td>${entry.note || ''}</td>
            </tr>
        `;
    }

    entryListElement.innerHTML = tableHtml; // テーブルの内容を更新
}
```

### 🔍 **実際の `index.html` / `script.js` では…？**

完成版ではテーブルの `<tbody>` が `id="list"` になっており、`script.js` でも

```javascript
entryListElement = document.getElementById('list');
totalCountElement = document.getElementById('total-count');
```

のように ID を合わせています。さらに、Bootstrap の `btn btn-sm btn-outline-danger` を使った Delete ボタンや、`totalCountElement` に件数を表示する処理、日付フィルタ（`#filter-date`）なども加わっています。この章のコードで流れをつかんだら、HTML の ID をそろえる → 件数表示を追加する → Delete ボタンを組み込む、といった順番で少しずつアプリを完成形に近づけてみてくださいね。

### **思考の軌跡** ：

「もし **データがない** 場合には、 **『データがありません』** というメッセージを表示するようにし、データがあればその内容を **テーブルの行** として追加していく。」

* **`entries.length === 0`** の部分で、もし`localStorage`にデータがない場合、「データがありません」と表示します。これにより、空の状態でもユーザーに分かりやすく伝えられます。
* データがある場合は、 **`for`ループ** で各エントリーをテーブルの行（`<tr>`）として追加しています。各データを`<td>`タグで挟んで、テーブルの **1行ずつ表示** します。

---

## 🌼 9.4 次に進むために

データの表示ができたら、次は **削除ボタン** の処理を行います。削除ボタンは、ユーザーが特定のデータを削除できるようにするための重要な機能です。この章では、 **削除ボタンの追加** は行いませんが、次の章でその機能を実装します。

### **思考の軌跡** ：

「削除ボタンを **次の章で** 実装するので、まずはデータが正しく表示されることを確認してから、削除ボタンやその処理を追加しよう。」

---

## 🌼 9.5 まとめ

この章では、次のことを実装しました：

* **`localStorage`からデータを取得** して、JavaScriptのオブジェクト（配列）として扱えるようにしました。
* 取得したデータを **テーブル形式で表示** しました。データがない場合は「データがありません」と表示し、データがあればその内容をテーブルに反映させました。

### **重要なポイント** ：

* **`localStorage`からデータを取得** して、 **`JSON.parse()`** でオブジェクトに戻してから、テーブルに表示する方法を学びました。
* **データがない場合** には **『データがありません』** というメッセージを表示し、データがあれば **テーブルに動的に挿入** しました。

次回は、 **削除ボタン** をテーブルに追加し、 **削除処理** を実装して、ユーザーがデータを削除できるようにします。

---

これで **第9章：データの表示** は終了です！次回は、 **削除機能** に進んでいきます。

> 🔁 表示結果が予想外なときは、`renderEntryTable` 冒頭で `console.log(entries)` を入れてみましょう。「そもそも localStorage に何が入っているか」を確認するだけで原因が見えることが多いです。わからなくなったら立ち止まって記録をのぞいてみてくださいね。
